import java.net.MalformedURLException;
import java.rmi.NotBoundException;
import java.rmi.RemoteException;
import java.util.Collection;
import java.util.Iterator;
import java.util.Scanner;
import java.util.UUID;

public class ClientMain {
	public static void clearConsole() {
		System.out.println("\u001b[H\u001b[2J");
	}
	
	public static void printCommands() {
		System.out.println("Lista de comandos:\nbind : Realiza a troca de servidor\nlistp \ngetp \nshowp \nclearlist \naddsubpart \naddp \nclear");	
	}
	
	public static void main(String[] args) throws MalformedURLException, RemoteException, NotBoundException {
		try (Scanner sc = new Scanner(System.in)) {
			System.out.println("Insira o nome do servidor: ");
			String serverName = sc.nextLine();
//			clearConsole();
			
			System.out.println("Insira a porta do servidor: ");
			String serverPort = sc.nextLine();
//			clearConsole();
			
			String server = "//localhost:";
					
			Client client = new Client(server+serverPort+"/"+serverName);
			
			printCommands();
			String command = sc.nextLine();
			while(!command.equals("quit")) {
				switch(command) {
					case "bind":
						System.out.println("Insira o nome do novo servidor: ");
						String newServerName = sc.nextLine();
//						clearConsole();
						
						System.out.println("Insira a porta do novo servidor: ");
						String newServerPort = sc.nextLine();
//						clearConsole();
						client.bind(server+newServerPort+"/"+newServerName);
						break;
					case "listp":
						System.out.println("Lista de Parts: ");
						Collection<Part> list = client.listp();
						Iterator<Part> iter= list.iterator();
						System.out.println("Lista de Parts\n\n");
						while (iter.hasNext()) {
				            System.out.println(iter.next().getName());
				        }
						break;
						
						
					case "getp":
						System.out.println("Insira o id desejado:\n\n");
						UUID idPart;
						try {
							idPart = UUID.fromString(sc.nextLine());
						} catch (Exception e) {
							System.out.println("Id inválido");
							break;
						}
						Part search = client.getp(idPart);
						if(search != null) {
							client.setPart(search);
						}
						else{
							System.out.println("Part não existente");
						}
						break;
					case "showp":
						Part show = client.getPart();
						if(show != null) {
							System.out.println("Id: " + show.getPartId());
							System.out.println("Nome: " + show.getName());
							System.out.println("Descrição: " + show.getDescription());
							System.out.println("Subparts: " + show.getSubParts());
						}
						else {
							System.out.println("Part não encontrada");
						}
						break;
					case "clearlist":
					case "addsubpart":
					case "addp":
					case "clear":
					default:
				}
			}
		}
	}
}
